- name: allowed-queries
  definition:
    queries:
    - name: ClearMessages
      query: "mutation ClearMessages {\r\n  delete_messages(where: {}) {\r\n    affected_rows\r\n
        \ }\r\n}"
    - name: OnNewMessage
      query: "subscription OnNewMessage {\r\n  messages(limit: 1, order_by: { timestamp:
        desc }) {\r\n    nonce\r\n    timestamp\r\n  }\r\n}"
    - name: NewMessage
      query: "mutation NewMessage($input: messages_insert_input!) {\r\n  insert_messages_one(object:
        $input) {\r\n    nonce\r\n    timestamp\r\n  }\r\n}"
    - name: SendMessage
      query: "mutation SendMessage($input: SendMessageInput!) {\r\n  sendMessage(input:
        $input) {\r\n    message_id\r\n    message {\r\n      ...Message\r\n    }\r\n
        \ }\r\n}\r\n\r\nfragment Message on messages {\r\n  content\r\n  guest_id\r\n
        \ guest_name\r\n  timestamp\r\n  nonce\r\n}"
    - name: MessagesRange
      query: |-
        query MessagesRange($from: timestamptz, $to: timestamptz) {
          messages(
            where: { timestamp: { _gt: $from, _lte: $to } }
            order_by: { timestamp: asc }
          ) {
            ...Message
          }
        }

        fragment Message on messages {
          content
          guest_id
          guest_name
          timestamp
          nonce
        }
    - name: LatestMessages
      query: |-
        query LatestMessages {
          messages(order_by: { timestamp: asc }) {
            ...Message
          }
        }

        fragment Message on messages {
          content
          guest_id
          guest_name
          timestamp
          nonce
        }
