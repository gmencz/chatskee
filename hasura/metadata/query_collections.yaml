- name: allowed-queries
  definition:
    queries:
    - name: LatestMessages
      query: |-
        query LatestMessages {
          messages(order_by: {message_number: asc}) {
            ...Message
          }
        }

        fragment Message on messages {
          id
          content
          guest_name
          created_at
        }
    - name: OnNewMessage
      query: |-
        subscription OnNewMessage {
          messages(limit: 1, order_by: {created_at: desc}) {
            id
            created_at
          }
        }
    - name: NewMessage
      query: |-
        mutation NewMessage($input: messages_insert_input!) {
          insert_messages_one(object: $input) {
            id
            created_at
          }
        }
    - name: MessagesRange
      query: |-
        query MessagesRange($from: timestamptz, $to: timestamptz) {
          messages(where: {created_at: {_gt: $from, _lte: $to}}, order_by: {message_number: asc}) {
            ...Message
          }
        }

        fragment Message on messages {
          id
          content
          guest_name
          created_at
        }
