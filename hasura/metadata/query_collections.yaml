- name: allowed-queries
  definition:
    queries:
    - name: LatestMessages
      query: |-
        query LatestMessages {
          messages(order_by: {message_number: asc}) {
            ...Message
          }
        }

        fragment Message on messages {
          id
          content
          guest_name
          created_at
        }
    - name: OnNewMessage
      query: |-
        subscription OnNewMessage {
          messages(limit: 1, order_by: {created_at: desc}) {
            id
            created_at
          }
        }
    - name: NewMessage
      query: |-
        mutation NewMessage($input: messages_insert_input!) {
          insert_messages_one(object: $input) {
            id
            created_at
          }
        }
    - name: MessagesRange
      query: |-
        query MessagesRange($from: timestamptz, $to: timestamptz) {
          messages(where: {created_at: {_gt: $from, _lte: $to}}, order_by: {message_number: asc}) {
            ...Message
          }
        }

        fragment Message on messages {
          id
          content
          guest_name
          created_at
        }
    - name: ClearMessages
      query: "mutation ClearMessages {\r\n  delete_messages(where: {}) {\r\n    affected_rows\r\n
        \ }\r\n}"
    - name: SendMessage
      query: "mutation SendMessage($input: SendMessageInput!) {\r\n  sendMessage(input:
        $input) {\r\n    message_id\r\n    message {\r\n      ...Message\r\n    }\r\n
        \ }\r\n}\r\n\r\nfragment Message on messages {\r\n  id\r\n  content\r\n  guest_name\r\n
        \ created_at\r\n}"
